diff --git a/index.html b/index.html
index ac09105bcd2a14df521cf10374e2032c32d973cf..4305a5e0cea1cc7acb4bf3f6ca0a047b8431ab79 100644
--- a/index.html
+++ b/index.html
@@ -12,51 +12,51 @@
   .day-btn.active { background-color: #0891b2; color: white; }
   .transaction-item:hover .action-btn { opacity: 1; }
   .action-btn { opacity: 0; transition: opacity 0.2s ease-in-out; }
   .modal-backdrop {
     background-color: rgba(0,0,0,0.5);
     transition: opacity 0.3s ease;
   }
 </style>
 </head>
 <body class="bg-gray-900 text-white antialiased">
 
 <div id="login-screen" class="min-h-screen flex items-center justify-center">
   <div class="bg-gray-800 p-8 rounded-xl shadow-lg border border-gray-700 w-full max-w-sm">
     <h2 class="text-3xl font-bold text-center text-cyan-400 mb-6">Barber<span class="text-white">Commission</span></h2>
     <div class="space-y-4">
       <div>
         <label for="email" class="block text-sm font-medium text-gray-300 mb-1">Email</label>
         <input type="email" id="email" class="w-full bg-gray-700 border border-gray-600 rounded-md px-3 py-2 focus:ring-2 focus:ring-cyan-500 transition" placeholder="admin@exemplo.com">
       </div>
       <div>
         <label for="password" class="block text-sm font-medium text-gray-300 mb-1">Senha</label>
         <input type="password" id="password" class="w-full bg-gray-700 border border-gray-600 rounded-md px-3 py-2 focus:ring-2 focus:ring-cyan-500 transition" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
       </div>
       <button id="loginBtn" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-md transition duration-300">Entrar</button>
     </div>
-    <p class="text-xs text-gray-500 mt-4 text-center">Use admin@exemplo.com (senha:)</p>
+    <p class="text-xs text-gray-500 mt-4 text-center">Use admin@exemplo.com (senha: 753951)</p>
   </div>
 </div>
 
 <div id="app-container" class="hidden">
   <div class="container mx-auto p-4 md:p-8 max-w-7xl">
 
     <header class="text-center mb-6">
       <h1 class="text-4xl font-bold text-cyan-400">Barber<span class="text-white">Commission</span></h1>
       <p class="text-gray-400 mt-2">Fechamento de comiss√£o semanal (Ter√ßa a S√°bado)</p>
       <p id="currentWeek" class="text-cyan-500 font-semibold mt-2"></p>
       <p id="welcomeMessage" class="text-white mt-2"></p>
     </header>
     
     <div id="admin-report-section" class="hidden bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700 mb-8">
         <h2 class="text-2xl font-semibold mb-4 text-center text-cyan-400">üìä Relat√≥rios da Barbearia</h2>
 
         <!-- NOVA SE√á√ÉO DE RELAT√ìRIOS PERSONALIZADOS -->
         <div class="bg-gray-700/50 p-4 rounded-lg border border-gray-600 mb-8">
             <h3 class="text-xl font-semibold text-center text-indigo-300 mb-4">Relat√≥rios Personalizados</h3>
             <div class="flex flex-wrap justify-center items-end gap-4">
                 <div>
                     <label for="customReportType" class="block text-sm font-medium text-gray-300 mb-1">Tipo de Relat√≥rio</label>
                     <select id="customReportType" class="bg-gray-600 border border-gray-500 rounded-md px-3 py-2 focus:ring-2 focus:ring-indigo-500 transition">
                         <option value="">Selecione...</option>
                         <option value="annual_barber">Faturamento Anual por Barbeiro</option>
@@ -117,126 +117,174 @@
                     <h4 class="text-lg font-medium text-gray-200 mb-2">Faturamento Real do M√™s</h4>
                     <div class="grid grid-cols-2 md:grid-cols-5 gap-4 text-center">
                         <div class="bg-gray-900/50 p-3 rounded-lg"><span class="block text-sm text-gray-400">Dinheiro</span><span id="monthlyReportDinheiro" class="font-bold text-lg text-green-400"></span></div>
                         <div class="bg-gray-900/50 p-3 rounded-lg"><span class="block text-sm text-gray-400">Pix</span><span id="monthlyReportPix" class="font-bold text-lg text-green-400"></span></div>
                         <div class="bg-gray-900/50 p-3 rounded-lg"><span class="block text-sm text-gray-400">D√©bito</span><span id="monthlyReportDebito" class="font-bold text-lg text-green-400"></span></div>
                         <div class="bg-gray-900/50 p-3 rounded-lg"><span class="block text-sm text-gray-400">Cr√©dito</span><span id="monthlyReportCredito" class="font-bold text-lg text-green-400"></span></div>
                         <div class="bg-cyan-800/50 p-3 rounded-lg col-span-2 md:col-span-1"><span class="block text-sm text-cyan-200">Total Real</span><span id="monthlyReportTotal" class="font-bold text-lg text-cyan-300"></span></div>
                     </div>
                 </div>
                 <div>
                     <h4 class="text-lg font-medium text-gray-200 mb-2">Servi√ßos Pagos com Assinatura no M√™s</h4>
                     <div class="bg-gray-900/50 p-4 rounded-lg flex justify-around items-center text-center">
                         <div>
                             <span class="block text-sm text-gray-400">N¬∫ de Servi√ßos</span>
                             <span id="monthlyReportAssinaturaCount" class="font-bold text-xl text-white">0</span>
                         </div>
                         <div>
                             <span class="block text-sm text-gray-400">Valor Total</span>
                             <span id="monthlyReportAssinaturaValue" class="font-bold text-xl text-white">R$ 0,00</span>
                         </div>
                     </div>
                 </div>
             </div>
         </div>
 
-        <hr class="border-gray-600 my-8">
-        
-        <h3 class="text-xl font-semibold text-center text-cyan-300 mb-4">Vis√£o Geral da Semana Atual</h3>
-        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-center">
+        <hr class="border-gray-600 my-8">
+
+        <h3 class="text-xl font-semibold text-center text-cyan-300 mb-4">Vis√£o Geral da Semana Atual</h3>
+        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-center">
             <div class="bg-gray-700 p-4 rounded-lg">
                 <h3 class="text-lg font-medium text-gray-300 mb-2">Faturamento Real (Semana Atual)</h3>
                 <div class="space-y-2 text-left">
                     <p class="flex justify-between"><span>Dinheiro:</span> <span id="reportDinheiro" class="font-semibold text-green-400">R$ 0,00</span></p>
                     <p class="flex justify-between"><span>Pix:</span> <span id="reportPix" class="font-semibold text-green-400">R$ 0,00</span></p>
                     <p class="flex justify-between"><span>D√©bito:</span> <span id="reportDebito" class="font-semibold text-green-400">R$ 0,00</span></p>
                     <p class="flex justify-between"><span>Cr√©dito:</span> <span id="reportCredito" class="font-semibold text-green-400">R$ 0,00</span></p>
                 </div>
             </div>
             <div class="bg-gray-700 p-4 rounded-lg flex flex-col justify-center items-center">
                 <h3 class="text-lg font-medium text-gray-300">Faturamento Bruto Semanal</h3>
                 <p class="text-sm text-gray-400">(Dinheiro, Pix, D√©bito, Cr√©dito)</p>
                 <p id="reportFaturamentoTotal" class="text-3xl font-bold text-cyan-400 mt-1">R$ 0,00</p>
             </div>
             <div class="bg-gray-700 p-4 rounded-lg">
                 <h3 class="text-lg font-medium text-gray-300 mb-2">Assinaturas (Semana Atual)</h3>
                 <p class="text-3xl font-bold" id="reportQtdAssinaturas">0</p>
                 <p class="text-gray-400">servi√ßos</p>
                 <p class="text-lg font-semibold text-cyan-400 mt-1" id="reportValorAssinaturas">R$ 0,00</p>
             </div>
             <div class="bg-gray-700 p-4 rounded-lg">
                 <h3 class="text-lg font-medium text-gray-300 mb-2">Cart√£o Presente (Semana Atual)</h3>
                 <p class="text-3xl font-bold" id="reportQtdCartaoPresente">0</p>
                 <p class="text-gray-400">servi√ßos</p>
                 <p class="text-lg font-semibold text-cyan-400 mt-1" id="reportValorCartaoPresente">R$ 0,00</p>
             </div>
             <div class="lg:col-span-2 bg-gray-700 p-4 rounded-lg md:col-span-2 lg:col-span-4 flex flex-col justify-center items-center">
                 <h3 class="text-lg font-medium text-gray-300">Comiss√£o de Assinaturas/Cart√£o Presente (Semana Atual)</h3>
                 <p id="reportComissaoAssinaturasCartao" class="text-3xl font-bold text-green-400 mt-2">R$ 0,00</p>
             </div>
             <div class="lg:col-span-2 bg-gray-700 p-4 rounded-lg">
                 <h3 class="text-lg font-medium text-gray-300 mb-2">Faturamento Di√°rio (Hoje)</h3>
                 <div class="space-y-2 text-left">
                     <p class="flex justify-between"><span>Dinheiro:</span> <span id="reportFaturamentoDiarioDinheiro" class="font-semibold text-teal-400">R$ 0,00</span></p>
                     <p class="flex justify-between"><span>Pix:</span> <span id="reportFaturamentoDiarioPix" class="font-semibold text-teal-400">R$ 0,00</span></p>
                     <p class="flex justify-between"><span>D√©bito:</span> <span id="reportFaturamentoDiarioDebito" class="font-semibold text-teal-400">R$ 0,00</span></p>
                     <p class="flex justify-between"><span>Cr√©dito:</span> <span id="reportFaturamentoDiarioCredito" class="font-semibold text-teal-400">R$ 0,00</span></p>
                     <hr class="border-gray-600"/>
                     <p class="flex justify-between items-center pt-2"><span class="font-medium text-gray-300">Total:</span><span id="reportFaturamentoDiarioTotal" class="text-xl font-bold text-teal-400">R$ 0,00</span></p>
                     <div id="dailyReportStatus" class="text-center text-gray-500 text-sm mt-1"></div>
                 </div>
             </div>
-            <div class="lg:col-span-2 bg-gray-700 p-4 rounded-lg flex flex-col">
-                <h3 class="text-lg font-medium text-gray-300 mb-2">Ranking de Faturamento (Semanal)</h3>
-                <div id="barberRankingList" class="space-y-2 flex-grow overflow-y-auto"></div>
-            </div>
-            <div class="lg:col-span-2 bg-gray-700 p-4 rounded-lg">
+            <div class="lg:col-span-2 bg-gray-700 p-4 rounded-lg flex flex-col">
+                <h3 class="text-lg font-medium text-gray-300 mb-2">Ranking de Faturamento (Semanal)</h3>
+                <div id="barberRankingList" class="space-y-2 flex-grow overflow-y-auto"></div>
+            </div>
+            <div class="lg:col-span-2 bg-gray-700 p-4 rounded-lg">
                 <h3 class="text-lg font-medium text-gray-300 mb-2">Faturamento Di√°rio - Loja 01 (Hoje)</h3>
                 <div class="space-y-2 text-left">
                     <p class="flex justify-between"><span>Dinheiro:</span> <span id="loja01DailyDinheiro" class="font-semibold text-blue-400">R$ 0,00</span></p>
                     <p class="flex justify-between"><span>Pix:</span> <span id="loja01DailyPix" class="font-semibold text-blue-400">R$ 0,00</span></p>
                     <p class="flex justify-between"><span>D√©bito:</span> <span id="loja01DailyDebito" class="font-semibold text-blue-400">R$ 0,00</span></p>
                     <p class="flex justify-between"><span>Cr√©dito:</span> <span id="loja01DailyCredito" class="font-semibold text-blue-400">R$ 0,00</span></p>
                     <hr class="border-gray-600"/><p class="flex justify-between items-center pt-2"><span class="font-medium text-gray-300">Total:</span><span id="loja01DailyTotal" class="text-xl font-bold text-blue-400">R$ 0,00</span></p>
                 </div>
                 <h3 class="text-lg font-medium text-gray-300 mt-4 mb-2">Faturamento Semanal - Loja 01</h3>
                 <p id="loja01WeeklyTotal" class="text-2xl font-bold text-blue-400">R$ 0,00</p>
             </div>
             <div class="lg:col-span-2 bg-gray-700 p-4 rounded-lg">
                 <h3 class="text-lg font-medium text-gray-300 mb-2">Faturamento Di√°rio - Loja 02 (Hoje)</h3>
                 <div class="space-y-2 text-left">
                     <p class="flex justify-between"><span>Dinheiro:</span> <span id="loja02DailyDinheiro" class="font-semibold text-yellow-400">R$ 0,00</span></p>
                     <p class="flex justify-between"><span>Pix:</span> <span id="loja02DailyPix" class="font-semibold text-yellow-400">R$ 0,00</span></p>
                     <p class="flex justify-between"><span>D√©bito:</span> <span id="loja02DailyDebito" class="font-semibold text-yellow-400">R$ 0,00</span></p>
                     <p class="flex justify-between"><span>Cr√©dito:</span> <span id="loja02DailyCredito" class="font-semibold text-yellow-400">R$ 0,00</span></p>
                     <hr class="border-gray-600"/><p class="flex justify-between items-center pt-2"><span class="font-medium text-gray-300">Total:</span><span id="loja02DailyTotal" class="text-xl font-bold text-yellow-400">R$ 0,00</span></p>
                 </div>
-                <h3 class="text-lg font-medium text-gray-300 mt-4 mb-2">Faturamento Semanal - Loja 02</h3>
-                <p id="loja02WeeklyTotal" class="text-2xl font-bold text-yellow-400">R$ 0,00</p>
-            </div>
-        </div>
-    </div>
+                <h3 class="text-lg font-medium text-gray-300 mt-4 mb-2">Faturamento Semanal - Loja 02</h3>
+                <p id="loja02WeeklyTotal" class="text-2xl font-bold text-yellow-400">R$ 0,00</p>
+            </div>
+        </div>
+
+        <div class="mt-8 grid grid-cols-1 lg:grid-cols-2 gap-6">
+            <div class="bg-gray-700/60 p-4 rounded-lg border border-gray-600">
+                <h3 class="text-lg font-semibold text-indigo-300 mb-3 text-center">Detalhamento Di√°rio da Semana Atual</h3>
+                <p class="text-sm text-gray-400 mb-3 text-center">Distribui√ß√£o por forma de pagamento, incluindo assinaturas e vendas de produtos/planos.</p>
+                <div class="overflow-x-auto">
+                    <table class="w-full text-sm text-left text-gray-300">
+                        <thead class="text-xs text-indigo-400 uppercase bg-gray-800">
+                            <tr>
+                                <th class="px-3 py-2">Dia</th>
+                                <th class="px-3 py-2 text-right">Dinheiro</th>
+                                <th class="px-3 py-2 text-right">Pix</th>
+                                <th class="px-3 py-2 text-right">D√©bito</th>
+                                <th class="px-3 py-2 text-right">Cr√©dito</th>
+                                <th class="px-3 py-2 text-right">Assinatura</th>
+                                <th class="px-3 py-2 text-right">Cart√£o Presente</th>
+                                <th class="px-3 py-2 text-right">Produtos</th>
+                                <th class="px-3 py-2 text-right">Planos/Vales</th>
+                                <th class="px-3 py-2 text-right">Total</th>
+                                <th class="px-3 py-2 text-right">Ticket M√©dio</th>
+                            </tr>
+                        </thead>
+                        <tbody id="dailyBreakdownTableBody"></tbody>
+                    </table>
+                </div>
+            </div>
+
+            <div class="bg-gray-700/60 p-4 rounded-lg border border-gray-600">
+                <h3 class="text-lg font-semibold text-indigo-300 mb-3 text-center">Painel por Barbeiro (Semana Atual)</h3>
+                <p class="text-sm text-gray-400 mb-3 text-center">Comparativo de faturamento real, produtos, assinaturas/cart√µes e planos.</p>
+                <div class="overflow-x-auto">
+                    <table class="w-full text-sm text-left text-gray-300">
+                        <thead class="text-xs text-indigo-400 uppercase bg-gray-800">
+                            <tr>
+                                <th class="px-3 py-2">Barbeiro</th>
+                                <th class="px-3 py-2 text-right">Faturamento Total</th>
+                                <th class="px-3 py-2 text-right">Servi√ßos</th>
+                                <th class="px-3 py-2 text-right">Produtos</th>
+                                <th class="px-3 py-2 text-right">Assin./Gift</th>
+                                <th class="px-3 py-2 text-right">Planos/Vale</th>
+                                <th class="px-3 py-2 text-right">Ticket M√©dio</th>
+                            </tr>
+                        </thead>
+                        <tbody id="barberBreakdownTableBody"></tbody>
+                    </table>
+                </div>
+            </div>
+        </div>
+    </div>
     
     <div id="admin-selector-container" class="max-w-md mx-auto mb-8 hidden">
       <label for="barberSelector" class="block text-center text-lg font-medium text-gray-300 mb-2">Selecione o Funcion√°rio (Vis√£o do Administrador)</label>
       <select id="barberSelector" class="w-full bg-gray-700 border border-gray-600 rounded-md px-3 py-3 text-lg focus:ring-2 focus:ring-cyan-500 transition"></select>
     </div>
 
     <div id="main-content" class="grid grid-cols-1 lg:grid-cols-5 gap-8 hidden">
 
       <div class="lg:col-span-3 flex flex-col gap-6">
         <div class="bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700">
           <h2 class="text-2xl font-semibold mb-4">Lan√ßamentos da Semana</h2>
           <div id="day-selector" class="grid grid-cols-3 sm:grid-cols-5 gap-2 mb-6"></div>
 
           <div id="transaction-form" class="bg-gray-700/50 p-4 rounded-lg space-y-4">
             <h3 class="font-semibold text-lg mb-3">Adicionar Lan√ßamento</h3>
             
             <div class="bg-gray-700/70 p-4 rounded-lg space-y-3 border border-gray-600">
                 <h4 class="font-semibold text-md text-cyan-300">Venda de Servi√ßo</h4>
                 <input type="text" id="clientName" placeholder="Nome do Cliente (opcional)" class="entry-input w-full bg-gray-600 border border-gray-500 rounded-md px-3 py-2">
                 <input type="text" id="serviceDescription" placeholder="Descri√ß√£o do Servi√ßo" class="entry-input w-full bg-gray-600 border border-gray-500 rounded-md px-3 py-2">
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                     <input type="number" id="serviceValue" placeholder="Valor do Servi√ßo (R$)" class="entry-input w-full bg-gray-600 border border-gray-500 rounded-md px-3 py-2">
                     <select id="paymentMethod" class="entry-input w-full bg-gray-600 border border-gray-500 rounded-md px-3 py-2">
                         <option value="Dinheiro">Dinheiro</option><option value="Pix">Pix</option><option value="D√©bito">D√©bito</option><option value="Cr√©dito">Cr√©dito</option><option value="Assinatura">Assinatura</option><option value="Cart√£o Presente">Cart√£o Presente</option>
                     </select>
@@ -419,58 +467,59 @@
   };
 
   let db;
   let selectedBarberId = null;
   let loggedInUser = null;
   let currentWeekId;
   let selectedDay;
   let weeklyData = {};
   let currentEditingTransactionId = null;
   let unsubscribeWeeklyData = () => {};
   let unsubscribeHistory = () => {};
   let unsubscribeWeeklyEntriesAdmin = () => {};
   let unsubscribeWeeklyClosingsAdmin = () => {};
 
   let latestWeeklyEntriesData = [];
   let latestWeeklyClosingsData = [];
 
   const weekDays = { 2: 'Ter√ßa', 3: 'Quarta', 4: 'Quinta', 5: 'Sexta', 6: 'S√°bado' };
   const REAL_PAYMENT_METHODS_ADMIN = ['Dinheiro', 'Pix', 'D√©bito', 'Cr√©dito'];
 
   let loginScreen, appContainer, barberSelector, mainContent, historySection, daySelector, addServiceTransactionBtn, addProductTransactionBtn, addPlanTransactionBtn, saveValeBtn, valeInput,
         dailyLog, dailyLogPlaceholder, transactionForm, editModal, closeEditModalBtn, saveEditBtn,
         editTransactionForm, closeWeekBtn, currentWeekSpan, historyTableBody, historyPlaceholder, summarySpans,
         adminSelectorContainer, welcomeMessage, loginBtn, emailInput, passwordInput, adminReportSection, adminReportSpans,
         detalheAssinaturas, detalheCartaoPresente, detalheDinheiro, detalhePix, detalheDebito, detalheCredito, detalheTotalProdutos,
-        barberDetailsSection, reportComissaoAssinaturasCartao, barberRankingList,
-        loja01DailyDinheiro, loja01DailyPix, loja01DailyDebito, loja01DailyCredito, loja01WeeklyTotal,
-        loja02DailyDinheiro, loja02DailyPix, loja02DailyDebito, loja02DailyCredito, loja02WeeklyTotal,
-        reportYear, reportMonth, generateMonthlyReportBtn, monthlyReportResults, monthlyReportTitle,
-        monthlyReportDinheiro, monthlyReportPix, monthlyReportDebito, monthlyReportCredito, monthlyReportTotal,
-        monthlyReportAssinaturaCount, monthlyReportAssinaturaValue, dailyReportStatus,
-        customReportType, yearSelectorContainer, customReportYear, dateRangeContainer, startDate, endDate,
-        generateCustomReportBtn, customReportResults, customReportTitle, customReportContent;
+        barberDetailsSection, reportComissaoAssinaturasCartao, barberRankingList,
+        loja01DailyDinheiro, loja01DailyPix, loja01DailyDebito, loja01DailyCredito, loja01WeeklyTotal,
+        loja02DailyDinheiro, loja02DailyPix, loja02DailyDebito, loja02DailyCredito, loja02WeeklyTotal,
+        reportYear, reportMonth, generateMonthlyReportBtn, monthlyReportResults, monthlyReportTitle,
+        monthlyReportDinheiro, monthlyReportPix, monthlyReportDebito, monthlyReportCredito, monthlyReportTotal,
+        monthlyReportAssinaturaCount, monthlyReportAssinaturaValue, dailyReportStatus,
+        customReportType, yearSelectorContainer, customReportYear, dateRangeContainer, startDate, endDate,
+        generateCustomReportBtn, customReportResults, customReportTitle, customReportContent,
+        dailyBreakdownTableBody, barberBreakdownTableBody;
 
   let comissaoAssinaturas, comissaoCartaoPresente;
   let reportFaturamentoDiarioTotal;
   let loja01DailyTotal;
   let loja02DailyTotal;
 
 
   const formatCurrency = (value) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(value);
 
   // --- BUG FIX ---
   // A fun√ß√£o foi reescrita para calcular o ID da semana de forma mais robusta,
   // tratando corretamente a transi√ß√£o entre as semanas de trabalho (Ter√ßa a S√°bado).
   function getWeekId(d = new Date()) {
     const date = new Date(d);
     // O dia da semana (0=Domingo, 1=Segunda, ..., 6=S√°bado)
     const day = date.getDay();
     
     // Ajusta a data para o in√≠cio da semana de trabalho (Ter√ßa-feira)
     // Se hoje for Domingo (0) ou Segunda (1), a data √© movida para a Ter√ßa-feira anterior
     // para garantir que a semana seja calculada corretamente.
     const dayOfWeek = day === 0 ? 6 : day - 1; // Ajusta para Segunda=0, ..., Domingo=6
     date.setDate(date.getDate() - dayOfWeek + 1); // Move para a Ter√ßa-feira
 
     // Agora, com a data no in√≠cio da semana correta, calculamos o n√∫mero da semana.
     const firstDayOfYear = new Date(date.getFullYear(), 0, 1);
@@ -509,74 +558,76 @@
     addPlanTransactionBtn = document.getElementById('addPlanTransactionBtn');
     saveValeBtn = document.getElementById('saveValeBtn');
     valeInput = document.getElementById('vale');
     dailyLog = document.getElementById('daily-log');
     dailyLogPlaceholder = document.getElementById('daily-log-placeholder');
     transactionForm = { 
         clientName: document.getElementById('clientName'), serviceDescription: document.getElementById('serviceDescription'), serviceValue: document.getElementById('serviceValue'), paymentMethod: document.getElementById('paymentMethod'), productDescription: document.getElementById('productDescription'), productsSold: document.getElementById('productsSold'), productSaleValue: document.getElementById('productSaleValue'), productPaymentMethod: document.getElementById('productPaymentMethod'), clientNamePlan: document.getElementById('clientNamePlan'), planSaleValue: document.getElementById('planSaleValue'), planSaleType: document.getElementById('planSaleType'), planSalePaymentMethod: document.getElementById('planSalePaymentMethod')  
     };
     editModal = document.getElementById('edit-modal');
     closeEditModalBtn = document.getElementById('close-edit-modal-btn');
     saveEditBtn = document.getElementById('saveEditBtn');
     editTransactionForm = { 
         clientName: document.getElementById('editClientName'), serviceDescription: document.getElementById('editServiceDescription'), serviceValue: document.getElementById('editServiceValue'), paymentMethod: document.getElementById('editPaymentMethod'), productDescription: document.getElementById('editProductDescription'), productsSold: document.getElementById('editProductsSold'), productSaleValue: document.getElementById('editProductSaleValue'), productPaymentMethod: document.getElementById('editProductPaymentMethod'), clientNamePlan: document.getElementById('editClientNamePlan'), planSaleValue: document.getElementById('editPlanSaleValue'), planSaleType: document.getElementById('editPlanSaleType'), planSalePaymentMethod: document.getElementById('editPlanSalePaymentMethod')  
     };
     closeWeekBtn = document.getElementById('closeWeekBtn');
     currentWeekSpan = document.getElementById('currentWeek');
     historyTableBody = document.getElementById('historyTableBody');
     historyPlaceholder = document.getElementById('historyPlaceholder');
     summarySpans = { faturamentoBruto: document.getElementById('faturamentoBruto'), comissaoServicos: document.getElementById('comissaoServicos'), comissaoProdutos: document.getElementById('comissaoProdutos'), subtotalComissao: document.getElementById('subtotalComissao'), descontoVale: document.getElementById('descontoVale'), comissaoFinal: document.getElementById('comissaoFinal') };
     adminReportSection = document.getElementById('admin-report-section');
     adminReportSpans = {
       faturamentoTotal: document.getElementById('reportFaturamentoTotal'), dinheiro: document.getElementById('reportDinheiro'), pix: document.getElementById('reportPix'), debito: document.getElementById('reportDebito'), credito: document.getElementById('reportCredito'), qtdAssinaturas: document.getElementById('reportQtdAssinaturas'), valorAssinaturas: document.getElementById('reportValorAssinaturas'), qtdCartaoPresente: document.getElementById('reportQtdCartaoPresente'), valorCartaoPresente: document.getElementById('reportValorCartaoPresente'), reportFaturamentoDiarioDinheiro: document.getElementById('reportFaturamentoDiarioDinheiro'), reportFaturamentoDiarioPix: document.getElementById('reportFaturamentoDiarioPix'), reportFaturamentoDiarioDebito: document.getElementById('reportFaturamentoDiarioDebito'), reportFaturamentoDiarioCredito: document.getElementById('reportFaturamentoDiarioCredito'), reportFaturamentoDiarioTotal: document.getElementById('reportFaturamentoDiarioTotal')
     };
     detalheAssinaturas = document.getElementById('detalheAssinaturas'); detalheCartaoPresente = document.getElementById('detalheCartaoPresente'); detalheDinheiro = document.getElementById('detalheDinheiro'); detalhePix = document.getElementById('detalhePix'); detalheDebito = document.getElementById('detalheDebito'); detalheCredito = document.getElementById('detalheCredito'); detalheTotalProdutos = document.getElementById('detalheTotalProdutos'); barberDetailsSection = document.getElementById('barberDetailsSection'); reportComissaoAssinaturasCartao = document.getElementById('reportComissaoAssinaturasCartao'); barberRankingList = document.getElementById('barberRankingList'); loja01DailyDinheiro = document.getElementById('loja01DailyDinheiro'); loja01DailyPix = document.getElementById('loja01DailyPix'); loja01DailyDebito = document.getElementById('loja01DailyDebito'); loja01DailyCredito = document.getElementById('loja01DailyCredito'); loja01WeeklyTotal = document.getElementById('loja01WeeklyTotal'); loja02DailyDinheiro = document.getElementById('loja02DailyDinheiro'); loja02DailyPix = document.getElementById('loja02DailyPix'); loja02DailyDebito = document.getElementById('loja02DailyDebito'); loja02DailyCredito = document.getElementById('loja02DailyCredito'); loja02WeeklyTotal = document.getElementById('loja02WeeklyTotal'); comissaoAssinaturas = document.getElementById('comissaoAssinaturas'); comissaoCartaoPresente = document.getElementById('comissaoCartaoPresente'); loja01DailyTotal = document.getElementById('loja01DailyTotal'); loja02DailyTotal = document.getElementById('loja02DailyTotal');
     
-    reportYear = document.getElementById('reportYear');
-    reportMonth = document.getElementById('reportMonth');
-    generateMonthlyReportBtn = document.getElementById('generateMonthlyReportBtn');
-    monthlyReportResults = document.getElementById('monthly-report-results');
-    monthlyReportTitle = document.getElementById('monthlyReportTitle');
+    reportYear = document.getElementById('reportYear');
+    reportMonth = document.getElementById('reportMonth');
+    generateMonthlyReportBtn = document.getElementById('generateMonthlyReportBtn');
+    monthlyReportResults = document.getElementById('monthly-report-results');
+    monthlyReportTitle = document.getElementById('monthlyReportTitle');
     monthlyReportDinheiro = document.getElementById('monthlyReportDinheiro');
     monthlyReportPix = document.getElementById('monthlyReportPix');
     monthlyReportDebito = document.getElementById('monthlyReportDebito');
     monthlyReportCredito = document.getElementById('monthlyReportCredito');
     monthlyReportTotal = document.getElementById('monthlyReportTotal');
     monthlyReportAssinaturaCount = document.getElementById('monthlyReportAssinaturaCount');
     monthlyReportAssinaturaValue = document.getElementById('monthlyReportAssinaturaValue');
     dailyReportStatus = document.getElementById('dailyReportStatus');
     
-    customReportType = document.getElementById('customReportType');
-    yearSelectorContainer = document.getElementById('year-selector-container');
-    customReportYear = document.getElementById('customReportYear');
-    dateRangeContainer = document.getElementById('date-range-container');
-    startDate = document.getElementById('startDate');
-    endDate = document.getElementById('endDate');
-    generateCustomReportBtn = document.getElementById('generateCustomReportBtn');
-    customReportResults = document.getElementById('custom-report-results');
-    customReportTitle = document.getElementById('customReportTitle');
-    customReportContent = document.getElementById('customReportContent');
+    customReportType = document.getElementById('customReportType');
+    yearSelectorContainer = document.getElementById('year-selector-container');
+    customReportYear = document.getElementById('customReportYear');
+    dateRangeContainer = document.getElementById('date-range-container');
+    startDate = document.getElementById('startDate');
+    endDate = document.getElementById('endDate');
+    generateCustomReportBtn = document.getElementById('generateCustomReportBtn');
+    customReportResults = document.getElementById('custom-report-results');
+    customReportTitle = document.getElementById('customReportTitle');
+    customReportContent = document.getElementById('customReportContent');
+    dailyBreakdownTableBody = document.getElementById('dailyBreakdownTableBody');
+    barberBreakdownTableBody = document.getElementById('barberBreakdownTableBody');
   }
 
   async function initializeAppAndAuth() {
     if (firebaseConfig.apiKey.includes("YOUR_API_KEY")) {
         alert("Please replace 'YOUR_API_KEY' with your actual Firebase API key.");
     }
     try {
         const app = initializeApp(firebaseConfig);
         db = getFirestore(app);
         const auth = getAuth(app);
         await signInAnonymously(auth);
         currentWeekId = getWeekId(new Date());
         initializeDOMReferences();
         setupLogin();
     } catch (error) {
         console.error("Firebase Init Error:", error);
         if (error.code === 'auth/configuration-not-found' || error.code === 'auth/operation-not-allowed') {
             alert("ERRO DE CONFIGURA√á√ÉO DO FIREBASE:\n\nPara o aplicativo funcionar, voc√™ precisa ATIVAR o provedor de login 'An√¥nimo'.\n\nCOMO RESOLVER:\n1. V√° ao seu painel do Firebase.\n2. No menu, clique em 'Authentication'.\n3. Clique na aba 'Sign-in method'.\n4. Encontre 'An√¥nimo' na lista e clique no l√°pis para editar.\n5. ATIVE a chave e clique em 'Salvar'.\n\nDepois disso, atualize a p√°gina.");
         } else if (error.code && error.code.includes('auth/requests-from-referer')) {
             alert("ERRO DE AUTORIZA√á√ÉO DE DOM√çNIO:\n\nO dom√≠nio em que o aplicativo est√° sendo executado n√£o est√° autorizado no Firebase.\n\nCOMO RESOLVER:\n1. V√° ao seu painel do Firebase.\n2. No menu, clique em 'Authentication'.\n3. Clique na aba 'Settings'.\n4. Em 'Dom√≠nios autorizados', clique em 'Adicionar dom√≠nio'.\n5. Copie o dom√≠nio da mensagem de erro no console (ex: '...usercontent.goog') e cole no campo.\n\nDepois disso, atualize a p√°gina.");
         } else {
             alert("ERRO CR√çTICO: N√£o foi poss√≠vel inicializar o Firebase. Detalhes: " + error.message);
         }
     }
   }
@@ -1211,217 +1262,353 @@
     summarySpans.comissaoFinal.textContent = formatCurrency(comissaoFinalSemana);
     
     detalheAssinaturas.textContent = formatCurrency(detalheAssinaturasDia); 
     detalheCartaoPresente.textContent = formatCurrency(detalheCartaoPresenteDia); 
     detalheDinheiro.textContent = formatCurrency(detalheDinheiroDia); 
     detalhePix.textContent = formatCurrency(detalhePixDia); 
     detalheDebito.textContent = formatCurrency(detalheDebitoDia); 
     detalheCredito.textContent = formatCurrency(detalheCreditoDia); 
     detalheTotalProdutos.textContent = detalheTotalProdutosDia;
   }
 
   function listenToAdminReportData() {
     if (unsubscribeWeeklyEntriesAdmin) unsubscribeWeeklyEntriesAdmin();
     if (unsubscribeWeeklyClosingsAdmin) unsubscribeWeeklyClosingsAdmin();
     const weeklyEntriesRef = collectionGroup(db, 'weekly_entries');
     unsubscribeWeeklyEntriesAdmin = onSnapshot(weeklyEntriesRef, (entriesSnapshot) => {
       latestWeeklyEntriesData = entriesSnapshot.docs.map(doc => ({ id: doc.id, barberId: doc.ref.parent.parent.id, data: doc.data() }));
       calculateAdminReport(latestWeeklyEntriesData);
     }, (error) => console.error("Erro ao ouvir entradas para relat√≥rio admin:", error));
     unsubscribeWeeklyClosingsAdmin = onSnapshot(collectionGroup(db, 'weekly_closings'), (closingsSnapshot) => {
       latestWeeklyClosingsData = closingsSnapshot.docs.map(doc => ({ id: doc.id, barberId: doc.ref.parent.parent.id, data: doc.data() }));
       calculateAdminReport(latestWeeklyEntriesData);
     }, (error) => console.error("Erro ao ouvir fechamentos para relat√≥rio admin:", error));
   }
 
-  function calculateAdminReport(allEntriesData) {
-    const totals = { faturamentoTotalCurrentWeek: 0, dinheiro: 0, pix: 0, debito: 0, credito: 0, qtdAssinaturas: 0, valorAssinaturas: 0, qtdCartaoPresente: 0, valorCartaoPresente: 0, comissaoAssinaturasCartao: 0, faturamentoDiarioDinheiro: 0, faturamentoDiarioPix: 0, faturamentoDiarioDebito: 0, faturamentoDiarioCredito: 0, loja01DailyDinheiro: 0, loja01DailyPix: 0, loja01DailyDebito: 0, loja01DailyCredito: 0, loja01WeeklyTotal: 0, loja02DailyDinheiro: 0, loja02DailyPix: 0, loja02DailyDebito: 0, loja02DailyCredito: 0, loja02WeeklyTotal: 0, };
-    const barberWeeklyRevenue = {};
-    const today = new Date();
-    const currentDayOfWeek = today.getDay();
-    const currentDayName = weekDays[currentDayOfWeek];
-    const currentWeekIdCalculated = getWeekId(today);
-    const barberNames = Object.fromEntries(Object.values(users).filter(u => u.role === 'barber').map(u => [u.barberId, u.name]));
+  function calculateAdminReport(allEntriesData) {
+    const totals = { faturamentoTotalCurrentWeek: 0, dinheiro: 0, pix: 0, debito: 0, credito: 0, qtdAssinaturas: 0, valorAssinaturas: 0, qtdCartaoPresente: 0, valorCartaoPresente: 0, comissaoAssinaturasCartao: 0, faturamentoDiarioDinheiro: 0, faturamentoDiarioPix: 0, faturamentoDiarioDebito: 0, faturamentoDiarioCredito: 0, loja01DailyDinheiro: 0, loja01DailyPix: 0, loja01DailyDebito: 0, loja01DailyCredito: 0, loja01WeeklyTotal: 0, loja02DailyDinheiro: 0, loja02DailyPix: 0, loja02DailyDebito: 0, loja02DailyCredito: 0, loja02WeeklyTotal: 0, };
+    const barberWeeklyRevenue = {};
+    const dailyBreakdown = Object.fromEntries(Object.values(weekDays).map(dayName => [dayName, { total: 0, dinheiro: 0, pix: 0, debito: 0, credito: 0, assinatura: 0, cartaoPresente: 0, produtos: 0, planos: 0, transacoes: 0 }]));
+    const barberBreakdown = {};
+    const today = new Date();
+    const currentDayOfWeek = today.getDay();
+    const currentDayName = weekDays[currentDayOfWeek];
+    const currentWeekIdCalculated = getWeekId(today);
+    const barberNames = Object.fromEntries(Object.values(users).filter(u => u.role === 'barber').map(u => [u.barberId, u.name]));
+
+    const ensureBarberRecord = (barberId) => {
+        if (!barberBreakdown[barberId]) {
+            barberBreakdown[barberId] = { name: barberNames[barberId] || barberId, total: 0, services: 0, products: 0, assinaturaCartao: 0, planos: 0, transacoes: 0 };
+        }
+    };
     
     for (const item of allEntriesData) {
         const barberId = item.barberId;
         const barberStore = barberStoreMap[barberId];
         
         if (item.id === currentWeekIdCalculated) {
             if (!barberWeeklyRevenue[barberId]) barberWeeklyRevenue[barberId] = 0;
 
             for (const dayKey in weekDays) { 
                 const dayName = weekDays[dayKey];
                 const dayData = item.data[dayName] || {};
-                const transactions = dayData.transactions || [];
-
-                for (const t of transactions) {
-                    if (t.serviceDescription && t.value > 0) {
-                        barberWeeklyRevenue[barberId] += t.value;
-
-                        if (t.paymentMethod === 'Assinatura') {
-                            totals.qtdAssinaturas++;
-                            totals.valorAssinaturas += t.value;
-                            totals.comissaoAssinaturasCartao += t.value * 0.50;
-                        } else if (t.paymentMethod === 'Cart√£o Presente') {
-                            totals.qtdCartaoPresente++;
-                            totals.valorCartaoPresente += t.value;
-                            totals.comissaoAssinaturasCartao += t.value * 0.50;
-                        }
-
-                        if (REAL_PAYMENT_METHODS_ADMIN.includes(t.paymentMethod)) {
-                            totals.faturamentoTotalCurrentWeek += t.value;
-                            
-                            switch (t.paymentMethod) {
-                                case 'Dinheiro': totals.dinheiro += t.value; break;
-                                case 'Pix': totals.pix += t.value; break;
-                                case 'D√©bito': totals.debito += t.value; break;
+                const transactions = dayData.transactions || [];
+
+                for (const t of transactions) {
+                    if (t.serviceDescription && t.value > 0) {
+                        barberWeeklyRevenue[barberId] += t.value;
+                        ensureBarberRecord(barberId);
+                        barberBreakdown[barberId].services += t.value;
+                        barberBreakdown[barberId].total += t.value;
+                        barberBreakdown[barberId].transacoes += 1;
+
+                        const dayTotals = dailyBreakdown[dayName];
+                        if (dayTotals) {
+                            dayTotals.transacoes += 1;
+                            dayTotals.total += t.value;
+                        }
+
+                        if (t.paymentMethod === 'Assinatura') {
+                            totals.qtdAssinaturas++;
+                            totals.valorAssinaturas += t.value;
+                            totals.comissaoAssinaturasCartao += t.value * 0.50;
+                            barberBreakdown[barberId].assinaturaCartao += t.value;
+                            if (dailyBreakdown[dayName]) dailyBreakdown[dayName].assinatura += t.value;
+                        } else if (t.paymentMethod === 'Cart√£o Presente') {
+                            totals.qtdCartaoPresente++;
+                            totals.valorCartaoPresente += t.value;
+                            totals.comissaoAssinaturasCartao += t.value * 0.50;
+                            barberBreakdown[barberId].assinaturaCartao += t.value;
+                            if (dailyBreakdown[dayName]) dailyBreakdown[dayName].cartaoPresente += t.value;
+                        }
+
+                        if (REAL_PAYMENT_METHODS_ADMIN.includes(t.paymentMethod)) {
+                            totals.faturamentoTotalCurrentWeek += t.value;
+                            if (dayTotals) {
+                                switch (t.paymentMethod) {
+                                    case 'Dinheiro': dayTotals.dinheiro += t.value; break;
+                                    case 'Pix': dayTotals.pix += t.value; break;
+                                    case 'D√©bito': dayTotals.debito += t.value; break;
+                                    case 'Cr√©dito': dayTotals.credito += t.value; break;
+                                }
+                            }
+
+                            switch (t.paymentMethod) {
+                                case 'Dinheiro': totals.dinheiro += t.value; break;
+                                case 'Pix': totals.pix += t.value; break;
+                                case 'D√©bito': totals.debito += t.value; break;
                                 case 'Cr√©dito': totals.credito += t.value; break;
                             }
                             
                             if (barberStore === 'loja01') totals.loja01WeeklyTotal += t.value;
                             else if (barberStore === 'loja02') totals.loja02WeeklyTotal += t.value;
 
                             if (currentDayName && dayName === currentDayName) {
                                 totals.faturamentoDiarioDinheiro += (t.paymentMethod === 'Dinheiro' ? t.value : 0);
                                 totals.faturamentoDiarioPix += (t.paymentMethod === 'Pix' ? t.value : 0);
                                 totals.faturamentoDiarioDebito += (t.paymentMethod === 'D√©bito' ? t.value : 0);
                                 totals.faturamentoDiarioCredito += (t.paymentMethod === 'Cr√©dito' ? t.value : 0);
 
                                 if (barberStore === 'loja01') {
                                     totals.loja01DailyDinheiro += (t.paymentMethod === 'Dinheiro' ? t.value : 0);
                                     totals.loja01DailyPix += (t.paymentMethod === 'Pix' ? t.value : 0);
                                     totals.loja01DailyDebito += (t.paymentMethod === 'D√©bito' ? t.value : 0);
                                     totals.loja01DailyCredito += (t.paymentMethod === 'Cr√©dito' ? t.value : 0);
                                 } else if (barberStore === 'loja02') {
                                     totals.loja02DailyDinheiro += (t.paymentMethod === 'Dinheiro' ? t.value : 0);
                                     totals.loja02DailyPix += (t.paymentMethod === 'Pix' ? t.value : 0);
                                     totals.loja02DailyDebito += (t.paymentMethod === 'D√©bito' ? t.value : 0);
                                     totals.loja02DailyCredito += (t.paymentMethod === 'Cr√©dito' ? t.value : 0);
                                 }
                             }
                         }
                     }
 
-                    if (t.productDescription && t.products > 0 && t.productSaleValue > 0 && REAL_PAYMENT_METHODS_ADMIN.includes(t.productPaymentMethod)) {
-                        barberWeeklyRevenue[barberId] += t.productSaleValue;
-                        totals.faturamentoTotalCurrentWeek += t.productSaleValue;
-                        
-                        switch (t.productPaymentMethod) {
-                            case 'Dinheiro': totals.dinheiro += t.productSaleValue; break;
-                            case 'Pix': totals.pix += t.productSaleValue; break;
-                            case 'D√©bito': totals.debito += t.productSaleValue; break;
-                            case 'Cr√©dito': totals.credito += t.productSaleValue; break;
-                        }
-
-                        if (barberStore === 'loja01') totals.loja01WeeklyTotal += t.productSaleValue;
-                        else if (barberStore === 'loja02') totals.loja02WeeklyTotal += t.productSaleValue;
-
-                        if (currentDayName && dayName === currentDayName) {
-                            totals.faturamentoDiarioDinheiro += (t.productPaymentMethod === 'Dinheiro' ? t.productSaleValue : 0);
-                            totals.faturamentoDiarioPix += (t.productPaymentMethod === 'Pix' ? t.productSaleValue : 0);
-                            totals.faturamentoDiarioDebito += (t.productPaymentMethod === 'D√©bito' ? t.productSaleValue : 0);
-                            totals.faturamentoDiarioCredito += (t.productPaymentMethod === 'Cr√©dito' ? t.productSaleValue : 0);
-
-                            if (barberStore === 'loja01') {
-                                totals.loja01DailyDinheiro += (t.productPaymentMethod === 'Dinheiro' ? t.productSaleValue : 0);
-                                totals.loja01DailyPix += (t.productPaymentMethod === 'Pix' ? t.productSaleValue : 0);
-                                totals.loja01DailyDebito += (t.productPaymentMethod === 'D√©bito' ? t.productSaleValue : 0);
-                                totals.loja01DailyCredito += (t.productPaymentMethod === 'Cr√©dito' ? t.productSaleValue : 0);
-                            } else if (barberStore === 'loja02') {
-                                totals.loja02DailyDinheiro += (t.productPaymentMethod === 'Dinheiro' ? t.productSaleValue : 0);
-                                totals.loja02DailyPix += (t.productPaymentMethod === 'Pix' ? t.productSaleValue : 0);
-                                totals.loja02DailyDebito += (t.productPaymentMethod === 'D√©bito' ? t.productSaleValue : 0);
-                                totals.loja02DailyCredito += (t.productPaymentMethod === 'Cr√©dito' ? t.productSaleValue : 0);
-                            }
-                        }
-                    }
-
-                    if (t.planSaleType && t.planSaleValue > 0 && REAL_PAYMENT_METHODS_ADMIN.includes(t.planSalePaymentMethod)) {
-                        totals.faturamentoTotalCurrentWeek += t.planSaleValue;
-                        
-                        switch (t.planSalePaymentMethod) {
-                            case 'Dinheiro': totals.dinheiro += t.planSaleValue; break;
-                            case 'Pix': totals.pix += t.planSaleValue; break;
-                            case 'D√©bito': totals.debito += t.planSaleValue; break;
-                            case 'Cr√©dito': totals.credito += t.planSaleValue; break;
-                        }
-
-                        if (barberStore === 'loja01') totals.loja01WeeklyTotal += t.planSaleValue;
-                        else if (barberStore === 'loja02') totals.loja02WeeklyTotal += t.planSaleValue;
+                    if (t.productDescription && t.products > 0 && t.productSaleValue > 0 && REAL_PAYMENT_METHODS_ADMIN.includes(t.productPaymentMethod)) {
+                        barberWeeklyRevenue[barberId] += t.productSaleValue;
+                        ensureBarberRecord(barberId);
+                        barberBreakdown[barberId].products += t.productSaleValue;
+                        barberBreakdown[barberId].total += t.productSaleValue;
+                        barberBreakdown[barberId].transacoes += 1;
+                        const dayTotals = dailyBreakdown[dayName];
+                        if (dayTotals) {
+                            dayTotals.transacoes += 1;
+                            dayTotals.total += t.productSaleValue;
+                            dayTotals.produtos += t.productSaleValue;
+                        }
+                        totals.faturamentoTotalCurrentWeek += t.productSaleValue;
+
+                        switch (t.productPaymentMethod) {
+                            case 'Dinheiro': totals.dinheiro += t.productSaleValue; break;
+                            case 'Pix': totals.pix += t.productSaleValue; break;
+                            case 'D√©bito': totals.debito += t.productSaleValue; break;
+                            case 'Cr√©dito': totals.credito += t.productSaleValue; break;
+                        }
+
+                        if (dayTotals) {
+                            switch (t.productPaymentMethod) {
+                                case 'Dinheiro': dayTotals.dinheiro += t.productSaleValue; break;
+                                case 'Pix': dayTotals.pix += t.productSaleValue; break;
+                                case 'D√©bito': dayTotals.debito += t.productSaleValue; break;
+                                case 'Cr√©dito': dayTotals.credito += t.productSaleValue; break;
+                            }
+                        }
+
+                        if (barberStore === 'loja01') totals.loja01WeeklyTotal += t.productSaleValue;
+                        else if (barberStore === 'loja02') totals.loja02WeeklyTotal += t.productSaleValue;
+
+                        if (currentDayName && dayName === currentDayName) {
+                            totals.faturamentoDiarioDinheiro += (t.productPaymentMethod === 'Dinheiro' ? t.productSaleValue : 0);
+                            totals.faturamentoDiarioPix += (t.productPaymentMethod === 'Pix' ? t.productSaleValue : 0);
+                            totals.faturamentoDiarioDebito += (t.productPaymentMethod === 'D√©bito' ? t.productSaleValue : 0);
+                            totals.faturamentoDiarioCredito += (t.productPaymentMethod === 'Cr√©dito' ? t.productSaleValue : 0);
+
+                            if (barberStore === 'loja01') {
+                                totals.loja01DailyDinheiro += (t.productPaymentMethod === 'Dinheiro' ? t.productSaleValue : 0);
+                                totals.loja01DailyPix += (t.productPaymentMethod === 'Pix' ? t.productSaleValue : 0);
+                                totals.loja01DailyDebito += (t.productPaymentMethod === 'D√©bito' ? t.productSaleValue : 0);
+                                totals.loja01DailyCredito += (t.productPaymentMethod === 'Cr√©dito' ? t.productSaleValue : 0);
+                            } else if (barberStore === 'loja02') {
+                                totals.loja02DailyDinheiro += (t.productPaymentMethod === 'Dinheiro' ? t.productSaleValue : 0);
+                                totals.loja02DailyPix += (t.productPaymentMethod === 'Pix' ? t.productSaleValue : 0);
+                                totals.loja02DailyDebito += (t.productPaymentMethod === 'D√©bito' ? t.productSaleValue : 0);
+                                totals.loja02DailyCredito += (t.productPaymentMethod === 'Cr√©dito' ? t.productSaleValue : 0);
+                            }
+                        }
+                    }
+
+                    if (t.planSaleType && t.planSaleValue > 0 && REAL_PAYMENT_METHODS_ADMIN.includes(t.planSalePaymentMethod)) {
+                        ensureBarberRecord(barberId);
+                        barberBreakdown[barberId].planos += t.planSaleValue;
+                        barberBreakdown[barberId].total += t.planSaleValue;
+                        barberBreakdown[barberId].transacoes += 1;
+                        const dayTotals = dailyBreakdown[dayName];
+                        if (dayTotals) {
+                            dayTotals.transacoes += 1;
+                            dayTotals.total += t.planSaleValue;
+                            dayTotals.planos += t.planSaleValue;
+                        }
+                        totals.faturamentoTotalCurrentWeek += t.planSaleValue;
+
+                        switch (t.planSalePaymentMethod) {
+                            case 'Dinheiro': totals.dinheiro += t.planSaleValue; break;
+                            case 'Pix': totals.pix += t.planSaleValue; break;
+                            case 'D√©bito': totals.debito += t.planSaleValue; break;
+                            case 'Cr√©dito': totals.credito += t.planSaleValue; break;
+                        }
+
+                        if (dayTotals) {
+                            switch (t.planSalePaymentMethod) {
+                                case 'Dinheiro': dayTotals.dinheiro += t.planSaleValue; break;
+                                case 'Pix': dayTotals.pix += t.planSaleValue; break;
+                                case 'D√©bito': dayTotals.debito += t.planSaleValue; break;
+                                case 'Cr√©dito': dayTotals.credito += t.planSaleValue; break;
+                            }
+                        }
+
+                        if (barberStore === 'loja01') totals.loja01WeeklyTotal += t.planSaleValue;
+                        else if (barberStore === 'loja02') totals.loja02WeeklyTotal += t.planSaleValue;
 
                         if (currentDayName && dayName === currentDayName) {
                             totals.faturamentoDiarioDinheiro += (t.planSalePaymentMethod === 'Dinheiro' ? t.planSaleValue : 0);
                             totals.faturamentoDiarioPix += (t.planSalePaymentMethod === 'Pix' ? t.planSaleValue : 0);
                             totals.faturamentoDiarioDebito += (t.planSalePaymentMethod === 'D√©bito' ? t.planSaleValue : 0);
                             totals.faturamentoDiarioCredito += (t.planSalePaymentMethod === 'Cr√©dito' ? t.planSaleValue : 0);
 
                             if (barberStore === 'loja01') {
                                 totals.loja01DailyDinheiro += (t.planSalePaymentMethod === 'Dinheiro' ? t.planSaleValue : 0);
                                 totals.loja01DailyPix += (t.planSalePaymentMethod === 'Pix' ? t.planSaleValue : 0);
                                 totals.loja01DailyDebito += (t.planSalePaymentMethod === 'D√©bito' ? t.planSaleValue : 0);
                                 totals.loja01DailyCredito += (t.planSalePaymentMethod === 'Cr√©dito' ? t.planSaleValue : 0);
                             } else if (barberStore === 'loja02') {
                                 totals.loja02DailyDinheiro += (t.planSalePaymentMethod === 'Dinheiro' ? t.planSaleValue : 0);
                                 totals.loja02DailyPix += (t.planSalePaymentMethod === 'Pix' ? t.planSaleValue : 0);
                                 totals.loja02DailyDebito += (t.planSalePaymentMethod === 'D√©bito' ? t.planSaleValue : 0);
                                 totals.loja02DailyCredito += (t.planSalePaymentMethod === 'Cr√©dito' ? t.planSaleValue : 0);
                             }
                         }
                     }
                 }
             }
         }
     }
 
     const rankedBarbersWeekly = Object.keys(barberWeeklyRevenue).map(barberId => ({ name: barberNames[barberId] || `Barbeiro ${barberId}`, revenue: barberWeeklyRevenue[barberId] })).sort((a, b) => b.revenue - a.revenue);
     adminReportSpans.reportFaturamentoDiarioDinheiro.textContent = formatCurrency(totals.faturamentoDiarioDinheiro); adminReportSpans.reportFaturamentoDiarioPix.textContent = formatCurrency(totals.faturamentoDiarioPix); adminReportSpans.reportFaturamentoDiarioDebito.textContent = formatCurrency(totals.faturamentoDiarioDebito); adminReportSpans.reportFaturamentoDiarioCredito.textContent = formatCurrency(totals.faturamentoDiarioCredito);
     const totalDailyAdmin = totals.faturamentoDiarioDinheiro + totals.faturamentoDiarioPix + totals.faturamentoDiarioDebito + totals.faturamentoDiarioCredito;
     adminReportSpans.reportFaturamentoDiarioTotal.textContent = formatCurrency(totalDailyAdmin);
 
     if (dailyReportStatus) {
         if (!currentDayName) {
             dailyReportStatus.textContent = `(Hoje n√£o √© um dia de faturamento ativo: ${today.toLocaleDateString('pt-BR', { weekday: 'long' })})`;
         } else {
             dailyReportStatus.textContent = '';
         }
     }
 
     adminReportSpans.faturamentoTotal.textContent = formatCurrency(totals.faturamentoTotalCurrentWeek); adminReportSpans.dinheiro.textContent = formatCurrency(totals.dinheiro); adminReportSpans.pix.textContent = formatCurrency(totals.pix); adminReportSpans.debito.textContent = formatCurrency(totals.debito); adminReportSpans.credito.textContent = formatCurrency(totals.credito); adminReportSpans.qtdAssinaturas.textContent = totals.qtdAssinaturas; adminReportSpans.valorAssinaturas.textContent = formatCurrency(totals.valorAssinaturas); adminReportSpans.qtdCartaoPresente.textContent = totals.qtdCartaoPresente; adminReportSpans.valorCartaoPresente.textContent = formatCurrency(totals.valorCartaoPresente); reportComissaoAssinaturasCartao.textContent = formatCurrency(totals.comissaoAssinaturasCartao);
     
-    loja01DailyDinheiro.textContent = formatCurrency(totals.loja01DailyDinheiro); loja01DailyPix.textContent = formatCurrency(totals.loja01DailyPix); loja01DailyDebito.textContent = formatCurrency(totals.loja01DailyDebito); loja01DailyCredito.textContent = formatCurrency(totals.loja01DailyCredito); loja01WeeklyTotal.textContent = formatCurrency(totals.loja01WeeklyTotal); const totalDailyLoja01 = totals.loja01DailyDinheiro + totals.loja01DailyPix + totals.loja01DailyDebito + totals.loja01DailyCredito; loja01DailyTotal.textContent = formatCurrency(totalDailyLoja01);
-    
-    loja02DailyDinheiro.textContent = formatCurrency(totals.loja02DailyDinheiro); loja02DailyPix.textContent = formatCurrency(totals.loja02DailyPix); loja02DailyDebito.textContent = formatCurrency(totals.loja02DailyDebito); loja02DailyCredito.textContent = formatCurrency(totals.loja02DailyCredito); loja02WeeklyTotal.textContent = formatCurrency(totals.loja02WeeklyTotal); const totalDailyLoja02 = totals.loja02DailyDinheiro + totals.loja02DailyPix + totals.loja02DailyDebito + totals.loja02DailyCredito; loja02DailyTotal.textContent = formatCurrency(totalDailyLoja02);
-    
-    barberRankingList.innerHTML = '';
-    if (rankedBarbersWeekly.length === 0) { barberRankingList.innerHTML = '<p class="text-gray-500 text-center">Nenhum faturamento semanal registrado ainda.</p>';
-    } else { rankedBarbersWeekly.forEach((barber, index) => {
-            const rankItem = document.createElement('div'); rankItem.className = 'flex justify-between items-center bg-gray-700/50 p-3 rounded-md';
-            rankItem.innerHTML = `<span class="font-medium text-gray-300">${index + 1}. ${barber.name}</span><span class="font-bold text-lg text-green-400">${formatCurrency(barber.revenue)}</span>`;
-            barberRankingList.appendChild(rankItem); });
-    }
-  }
+    loja01DailyDinheiro.textContent = formatCurrency(totals.loja01DailyDinheiro); loja01DailyPix.textContent = formatCurrency(totals.loja01DailyPix); loja01DailyDebito.textContent = formatCurrency(totals.loja01DailyDebito); loja01DailyCredito.textContent = formatCurrency(totals.loja01DailyCredito); loja01WeeklyTotal.textContent = formatCurrency(totals.loja01WeeklyTotal); const totalDailyLoja01 = totals.loja01DailyDinheiro + totals.loja01DailyPix + totals.loja01DailyDebito + totals.loja01DailyCredito; loja01DailyTotal.textContent = formatCurrency(totalDailyLoja01);
+
+    loja02DailyDinheiro.textContent = formatCurrency(totals.loja02DailyDinheiro); loja02DailyPix.textContent = formatCurrency(totals.loja02DailyPix); loja02DailyDebito.textContent = formatCurrency(totals.loja02DailyDebito); loja02DailyCredito.textContent = formatCurrency(totals.loja02DailyCredito); loja02WeeklyTotal.textContent = formatCurrency(totals.loja02WeeklyTotal); const totalDailyLoja02 = totals.loja02DailyDinheiro + totals.loja02DailyPix + totals.loja02DailyDebito + totals.loja02DailyCredito; loja02DailyTotal.textContent = formatCurrency(totalDailyLoja02);
+
+    renderDailyBreakdownTable(dailyBreakdown);
+    renderBarberBreakdownTable(barberBreakdown);
+
+    barberRankingList.innerHTML = '';
+    if (rankedBarbersWeekly.length === 0) { barberRankingList.innerHTML = '<p class="text-gray-500 text-center">Nenhum faturamento semanal registrado ainda.</p>';
+    } else { rankedBarbersWeekly.forEach((barber, index) => {
+            const rankItem = document.createElement('div'); rankItem.className = 'flex justify-between items-center bg-gray-700/50 p-3 rounded-md';
+            rankItem.innerHTML = `<span class="font-medium text-gray-300">${index + 1}. ${barber.name}</span><span class="font-bold text-lg text-green-400">${formatCurrency(barber.revenue)}</span>`;
+            barberRankingList.appendChild(rankItem); });
+    }
+  }
+
+  function renderDailyBreakdownTable(breakdown) {
+    if (!dailyBreakdownTableBody) return;
+    dailyBreakdownTableBody.innerHTML = '';
+    const orderedDays = [2, 3, 4, 5, 6].map(dayIndex => weekDays[dayIndex]);
+    let hasData = false;
+
+    orderedDays.forEach(dayName => {
+        const dayTotals = breakdown[dayName];
+        if (!dayTotals) return;
+        const ticketMedio = dayTotals.transacoes > 0 ? dayTotals.total / dayTotals.transacoes : 0;
+        if (dayTotals.total > 0) hasData = true;
+        const row = document.createElement('tr');
+        row.className = 'bg-gray-800 border-b border-gray-700';
+        row.innerHTML = `
+            <td class="px-3 py-2 font-medium">${dayName}</td>
+            <td class="px-3 py-2 text-right">${formatCurrency(dayTotals.dinheiro)}</td>
+            <td class="px-3 py-2 text-right">${formatCurrency(dayTotals.pix)}</td>
+            <td class="px-3 py-2 text-right">${formatCurrency(dayTotals.debito)}</td>
+            <td class="px-3 py-2 text-right">${formatCurrency(dayTotals.credito)}</td>
+            <td class="px-3 py-2 text-right">${formatCurrency(dayTotals.assinatura)}</td>
+            <td class="px-3 py-2 text-right">${formatCurrency(dayTotals.cartaoPresente)}</td>
+            <td class="px-3 py-2 text-right">${formatCurrency(dayTotals.produtos)}</td>
+            <td class="px-3 py-2 text-right">${formatCurrency(dayTotals.planos)}</td>
+            <td class="px-3 py-2 text-right font-semibold text-green-400">${formatCurrency(dayTotals.total)}</td>
+            <td class="px-3 py-2 text-right">${ticketMedio > 0 ? formatCurrency(ticketMedio) : '‚Äî'}</td>
+        `;
+        dailyBreakdownTableBody.appendChild(row);
+    });
+
+    if (!hasData) {
+        const row = document.createElement('tr');
+        row.innerHTML = '<td colspan="11" class="text-center py-4 text-gray-500">Nenhum lan√ßamento encontrado para esta semana.</td>';
+        dailyBreakdownTableBody.appendChild(row);
+    }
+  }
+
+  function renderBarberBreakdownTable(breakdown) {
+    if (!barberBreakdownTableBody) return;
+    barberBreakdownTableBody.innerHTML = '';
+    const items = Object.values(breakdown).sort((a, b) => b.total - a.total);
+
+    if (items.length === 0) {
+        const row = document.createElement('tr');
+        row.innerHTML = '<td colspan="7" class="text-center py-4 text-gray-500">Nenhum dado consolidado at√© o momento.</td>';
+        barberBreakdownTableBody.appendChild(row);
+        return;
+    }
+
+    items.forEach(item => {
+        const ticketMedio = item.transacoes > 0 ? item.total / item.transacoes : 0;
+        const row = document.createElement('tr');
+        row.className = 'bg-gray-800 border-b border-gray-700';
+        row.innerHTML = `
+            <td class="px-3 py-2 font-medium">${item.name}</td>
+            <td class="px-3 py-2 text-right font-semibold text-green-400">${formatCurrency(item.total)}</td>
+            <td class="px-3 py-2 text-right">${formatCurrency(item.services)}</td>
+            <td class="px-3 py-2 text-right">${formatCurrency(item.products)}</td>
+            <td class="px-3 py-2 text-right">${formatCurrency(item.assinaturaCartao)}</td>
+            <td class="px-3 py-2 text-right">${formatCurrency(item.planos)}</td>
+            <td class="px-3 py-2 text-right">${ticketMedio > 0 ? formatCurrency(ticketMedio) : '‚Äî'}</td>
+        `;
+        barberBreakdownTableBody.appendChild(row);
+    });
+  }
 
   async function closeWeek() {
     if (loggedInUser.role !== 'admin') { alert("Apenas administradores podem encerrar a semana."); return; }
     if (Object.keys(weeklyData).length === 0) { alert("N√£o h√° dados para fechar esta semana."); return; }
     if (!confirm("Tem certeza que deseja encerrar a semana para este funcion√°rio? Esta a√ß√£o n√£o pode ser desfeita e ir√° arquivar os resultados.")) { return; }
     let totalBruto = 0, comissaoServicos = 0, totalVale = 0, totalProdutos = 0, comissaoAssinaturasVal = 0, comissaoCartaoPresenteVal = 0;
     Object.values(weeklyData).forEach(dayData => {
       const transactions = dayData.transactions || [];
       transactions.forEach(t => {
         totalProdutos += t.products || 0;
         if (t.serviceDescription && t.value > 0) {
           totalBruto += t.value; 
           if (t.paymentMethod === 'Assinatura') { comissaoAssinaturasVal += t.value * 0.50; }
           else if (t.paymentMethod === 'Cart√£o Presente') { comissaoCartaoPresenteVal += t.value * 0.50; }
           else {
             let commissionableValue = t.value;
             if (t.paymentMethod === 'D√©bito') commissionableValue *= (1 - 0.015); else if (t.paymentMethod === 'Cr√©dito') commissionableValue *= (1 - 0.05);
             comissaoServicos += commissionableValue * 0.50;
           }
         }
       });
       totalVale += dayData.vale || 0;
     });
     const comissaoProdutos = totalProdutos * 5; const subtotalComissao = comissaoServicos + comissaoAssinaturasVal + comissaoCartaoPresenteVal + comissaoProdutos; const comissaoFinal = subtotalComissao - totalVale;
     const weekStartDate = new Date(); weekStartDate.setDate(weekStartDate.getDate() - (weekStartDate.getDay() - 2 + 7) % 7); const weekEndDate = new Date(weekStartDate); weekEndDate.setDate(weekEndDate.getDate() + 4); const periodo = `${weekStartDate.toLocaleDateString('pt-BR')} - ${weekEndDate.toLocaleDateString('pt-BR')}`;
